"use strict";(()=>{var n={promise:null,load:e=>{typeof Twitch<"u"?n.promise=new Promise(a=>{a()}).then(()=>{n._createPlayer(e)}):(n.promise=n.promise||mejs.Utils.loadScript("https://player.twitch.tv/js/embed/v1.js"),n.promise.then(()=>{n._createPlayer(e)}))},_createPlayer:e=>{let a=new Twitch.Player(e.id,e);window[`__ready__${e.id}`](a)},getTwitchId:e=>{let a="";return e.indexOf("?")>0?(a=n.getTwitchIdFromParam(e),a===""&&(a=n.getTwitchIdFromUrl(e))):a=n.getTwitchIdFromUrl(e),a},getTwitchIdFromParam:e=>{if(e==null||!e.trim().length)return null;let a=e.split("?"),u=a[1].split("&"),t="";for(let o=0,I=u.length;o<I;o++){let h=u[o].split("=");if(~h[0].indexOf("channel")){t=h[1];break}else if(~h[0].indexOf("video")){t=`v${h[1]}`;break}}return t},getTwitchIdFromUrl:e=>{if(e==null||!e.trim().length)return null;e=e.split("?")[0];let u=e.substring(e.lastIndexOf("/")+1);return/^\d+$/i.test(u)?`v${u}`:u},getTwitchType:e=>/^v\d+/i.test(e)?"video":"channel"},A={name:"twitch_iframe",options:{prefix:"twitch_iframe"},canPlayType:e=>~["video/twitch","video/x-twitch"].indexOf(e.toLowerCase()),create:(e,a,u)=>{let t={},o=[],h=n.getTwitchId(u[0].src),i=null,p=!0,g=!1,T=!1,P=1,b=1/0,U=0;t.options=a,t.id=e.id+"_"+a.prefix,t.mediaElement=e;let N=mejs.html5media.properties,k=s=>{let r=`${s.substring(0,1).toUpperCase()}${s.substring(1)}`;t[`get${r}`]=()=>{if(i!==null){switch(s){case"currentTime":return U=i.getCurrentTime(),U;case"duration":return b=i.getDuration(),b;case"volume":return P=i.getVolume(),P;case"paused":return p=i.isPaused(),p;case"ended":return g=i.getEnded(),g;case"muted":return i.getMuted();case"buffered":return{start:()=>0,end:()=>0,length:1};case"src":return n.getTwitchType(h)==="channel"?i.getChannel():i.getVideo();case"readyState":return 4}return null}else return null},t[`set${r}`]=l=>{if(i!==null)switch(s){case"src":let v=typeof l=="string"?l:l[0].src,f=n.getTwitchId(v);n.getTwitchType(h)==="channel"?i.setChannel(f):i.setVideo(f);break;case"currentTime":i.seek(l),setTimeout(()=>{let c=mejs.Utils.createEvent("timeupdate",t);e.dispatchEvent(c)},50);break;case"muted":i.setMuted(l),setTimeout(()=>{let c=mejs.Utils.createEvent("volumechange",t);e.dispatchEvent(c)},50);break;case"volume":P=l,i.setVolume(l),setTimeout(()=>{let c=mejs.Utils.createEvent("volumechange",t);e.dispatchEvent(c)},50);break;case"readyState":let d=mejs.Utils.createEvent("canplay",t);e.dispatchEvent(d);break;default:console.log("Twitch "+t.id,s,"UNSUPPORTED property");break}else o.push({type:"set",propName:s,value:l})}};for(let s=0,r=N.length;s<r;s++)k(N[s]);let _=mejs.html5media.methods,S=s=>{t[s]=()=>{if(i!==null)switch(s){case"play":return p=!1,i.play();case"pause":return p=!0,i.pause();case"load":return null}else o.push({type:"call",methodName:s})}};for(let s=0,r=_.length;s<r;s++)S(_[s]);function w(s){for(let r=0,l=s.length;r<l;r++){let v=mejs.Utils.createEvent(s[r],t,!0);e.dispatchEvent(v)}}window["__ready__"+t.id]=s=>{if(e.twitchPlayer=i=s,o.length)for(let d=0,c=o.length;d<c;d++){let m=o[d];if(m.type==="set"){let E=m.propName,L=`${E.substring(0,1).toUpperCase()}${E.substring(1)}`;t[`set${L}`](m.value)}else m.type==="call"&&t[m.methodName]()}let r=document.getElementById(t.id).firstChild;r.style.width="100%",r.style.height="100%";let l=["mouseover","mouseout"],v=d=>{let c=mejs.Utils.createEvent(d.type,t);e.dispatchEvent(c)};for(let d=0,c=l.length;d<c;d++)r.addEventListener(l[d],v,!1);let f;i.addEventListener(Twitch.Player.READY,()=>{p=!1,g=!1,w(["rendererready","loadedmetadata","loadeddata","canplay"])}),i.addEventListener(Twitch.Player.PLAY,()=>{T||(T=!0),p=!1,g=!1,w(["play","playing","progress"]),f=setInterval(()=>{i.getCurrentTime(),w(["timeupdate"])},250)}),i.addEventListener(Twitch.Player.PAUSE,()=>{p=!0,g=!1,i.getEnded()||w(["pause"])}),i.addEventListener(Twitch.Player.ENDED,()=>{p=!0,g=!0,w(["ended"]),clearInterval(f),T=!1,f=null})};let $=e.originalNode.height,C=e.originalNode.width,y=document.createElement("div"),x=n.getTwitchType(h),j={id:t.id,width:C,height:$,playsinline:!1,autoplay:e.originalNode.autoplay,muted:e.originalNode.muted};return j[x]=h,y.id=t.id,y.style.width="100%",y.style.height="100%",e.originalNode.parentNode.insertBefore(y,e.originalNode),e.originalNode.style.display="none",e.originalNode.autoplay=!1,t.setSize=(s,r)=>{n!==null&&!isNaN(s)&&!isNaN(r)&&(y.setAttribute("width",s),y.setAttribute("height",r))},t.hide=()=>{t.pause(),y.style.display="none"},t.show=()=>{y.style.display=""},t.destroy=()=>{},n.load(j),t}};mejs.Utils.typeChecks.push(e=>/\/\/(www|player).twitch.tv/i.test(e)?"video/x-twitch":null);mejs.Renderers.add(A);})();
